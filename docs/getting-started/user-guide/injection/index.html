<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <meta property="article:modified_time" content="2024-03-27T15:35:22-05:00" /><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Task Profiling" href="../task-profiling.html" /><link rel="prev" title="Signal Logging (Streaming)" href="../logging/streaming.html" />
        <link rel="canonical" href="https://docs.amdc.dev/getting-started/user-guide/injection/index.html" />

    <link rel="shortcut icon" href="../../../_static/favicon.png"/><!-- Generated with Sphinx 6.2.1 and Furo 2024.08.06 -->
        <title>Signal Injection - AMDC Platform</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=04c057b233f3c8d71940eee6080f658a04e2027d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=cf727022eb7470bc603c08d2e55c3247faec75c9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">AMDC Platform</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">AMDC Platform</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">GitHub Repositories</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Severson-Group/AMDC-Hardware">AMDC-Hardware</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Severson-Group/AMDC-Firmware">AMDC-Firmware</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../onboarding.html">Onboarding</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/meet-amdc/index.html">Meet the AMDC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/blink/index.html">Blink</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/hw-commands/index.html">Hardware Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/vsi/index.html">Voltage Source Inverter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/profiling-tasks/index.html">Profiling Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/timing-manager/index.html">Timing &amp; Sensors</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../advanced-tutorials/index.html">Advanced Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Advanced Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-tutorials/custom-control-rate/index.html">Custom Control Rate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced-tutorials/fpga-ip-core/index.html">Custom FPGA IP Core</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">User Guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../host-interface/index.html">Host Interface</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Host Interface</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../host-interface/python-wrapper.html">Python Wrapper</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../logging/index.html">Signal Logging</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Signal Logging</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../logging/buffered.html">Buffered</a></li>
<li class="toctree-l3"><a class="reference internal" href="../logging/streaming.html">Streaming</a></li>
</ul>
</li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Signal Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../task-profiling.html">Task Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math-benchmarks/math-benchmarks.html">Math Benchmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../amds-interface/index.html">AMDS Interface</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../control-with-amdc/index.html">Control with AMDC</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Control with AMDC</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../control-with-amdc/current-sensor-cal/index.html">Current Sensor Calibration</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hardware</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../hardware/index.html">Hardware Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hardware/obtaining-hardware.html">Obtaining Hardware</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../hardware/subsystems/index.html">Subsystems</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Subsystems</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../hardware/subsystems/picozed.html">PicoZed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../hardware/subsystems/analog.html">Analog Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../hardware/subsystems/encoder.html">Encoder Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../hardware/subsystems/power-distribution.html">Power Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../hardware/subsystems/power-stack.html">Power Stack Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../hardware/subsystems/expansion-port.html">Expansion Port</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../hardware/revisions/index.html">PCB Revisions</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of PCB Revisions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../hardware/revisions/firmware-upgrades-per-hardware-target.html">Firmware Upgrades Per Hardware Target</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../hardware/revisions/rev-d/index.html">REV D Hardware</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of REV D Hardware</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../hardware/revisions/rev-d/rev-d-bring-up.html">REV D Bring-Up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../hardware/revisions/rev-d/rev-d-errata.html">REV D Errata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../hardware/revisions/rev-d/rev-d-pin-mapping.html">REV D Pin Mapping</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../hardware/revisions/rev-e/index.html">REV E Hardware</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of REV E Hardware</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../hardware/revisions/rev-e/rev-e-bring-up.html">REV E Bring-Up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../hardware/revisions/rev-e/rev-e-pin-mapping.html">REV E Pin Mapping</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../hardware/revisions/rev-f/index.html">REV F Hardware</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of REV F Hardware</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../hardware/revisions/rev-f/rev-f-bring-up.html">REV F Bring-Up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../hardware/revisions/rev-f/rev-f-pin-mapping.html">REV F Pin Mapping</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Firmware</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../firmware/index.html">Firmware Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../firmware/development/index.html">Development</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../firmware/arch/index.html">Architecture</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Architecture</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../firmware/arch/drivers/index.html">Drivers</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Drivers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../firmware/arch/drivers/gpio-mux.html">GPIO Port Mux Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../firmware/arch/drivers/status-mux.html">Inverter Status Mux Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../firmware/arch/drivers/encoder.html">Encoder Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../firmware/arch/drivers/eddy-current-sensor.html">Eddy Current Sensor Driver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../firmware/arch/system.html">System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../firmware/arch/timing-manager.html">Timing Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../firmware/arch/user-apps.html">User Apps</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../firmware/xilinx-tools/index.html">Xilinx Tools</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Xilinx Tools</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../firmware/xilinx-tools/installing-xilinx-tools.html">Installing Xilinx Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../firmware/xilinx-tools/building-and-running-firmware.html">Building and Running Firmware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../firmware/xilinx-tools/flashing.html">Flashing AMDC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../firmware/xilinx-tools/create-private-repo.html">Create Private Repo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../firmware/xilinx-tools/create-user-app.html">Create Custom User App</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../firmware/xilinx-tools/dual-core.html">Dual Core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../firmware/xilinx-tools/low-level-debugging.html">Low-Level Debugging</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Accessories</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../accessories/amds/index.html">AMDS</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of AMDS</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../accessories/amds/amds-in-action/index.html">AMDS in Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../accessories/amds/firmware/index.html">Firmware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../accessories/amds/mainboard/index.html">Mainboard</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../accessories/amds/sensor-cards/index.html">Sensor Cards</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Sensor Cards</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../accessories/amds/sensor-cards/high-voltage/index.html">High Voltage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../accessories/amds/sensor-cards/low-voltage/index.html">Low Voltage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../accessories/amds/sensor-cards/current/index.html">Current</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../accessories/uinverter/index.html">μInverter</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of μInverter</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../accessories/uinverter/hardware-design.html">Hardware Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../accessories/uinverter/connections.html">Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../accessories/uinverter/rl-est/index.html">RL Estimation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../accessories/dac/index.html">DAC</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of DAC</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../accessories/dac/pcb-electrical-tests.html">PCB Electrical Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../accessories/test-board/index.html">TestBoard</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/Severson-Group/docs.amdc.dev/blob/main/source/getting-started/user-guide/injection/index.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/Severson-Group/docs.amdc.dev/edit/main/source/getting-started/user-guide/injection/index.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="signal-injection">
<h1>Signal Injection<a class="headerlink" href="#signal-injection" title="Permalink to this heading">¶</a></h1>
<p>The AMDC is designed to run control algorithms implemented in C-code.
Control algorithms can usually be described in block digram form where signals flow between various blocks.
Injecting and manipulating signals as they flow is often useful for validation of controllers.</p>
<p>For easy signal injection, the AMDC firmware library includes a module called <code class="code docutils literal notranslate"><span class="pre">sys/injection</span></code> which handles the common signal creation and user command interface.
Users can easily build numerous injection points into their controller code.</p>
<p>The remainder of this document explains how to add injection points, how to use the injection module, and example use cases.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Injections pair nicely with <a class="reference internal" href="../logging/index.html"><span class="doc">Signal Logging</span></a>!</p>
</div>
<section id="what-are-injections">
<h2>What Are Injections?<a class="headerlink" href="#what-are-injections" title="Permalink to this heading">¶</a></h2>
<p>Injections refer to adding or modifying signals in a control algorithm.
For each location a signal is modified, a so-called <strong>injection point</strong> is added.
Each injection point can be visualized as a block which takes an optional input and provides an output.
Internally, the injection point block computes a prescribed function and combines it with the input signal to create the output signal.
The output combination can either replace or augment the input signal.</p>
<p>Each injection point can be visualized like this:</p>
<img alt="../../../_images/inj-point.svg" class="align-center" src="../../../_images/inj-point.svg" /><p>Each <code class="code docutils literal notranslate"><span class="pre">Function</span> <span class="pre">Generator</span></code> block in the stack implements one type of function: constant, white noise, triangle, square, chirp, sine, etc.
The output is formed via the mux selecting either: (i) just the function generator output, or (ii) a sum/difference of the function generator output with the input signal.</p>
<p>These blocks are generic and can be used many times through-out a control algorithm.</p>
<p><strong>Note that, by default, the injection point is “disabled” and acts as a pass-through – the output signal is the input signal.</strong>
<strong>The user must manually enable the injection during operation.</strong></p>
</section>
<section id="example-use-cases">
<h2>Example Use Cases<a class="headerlink" href="#example-use-cases" title="Permalink to this heading">¶</a></h2>
<p>Consider the following (typical) control structure:</p>
<img alt="../../../_images/control-diagram.svg" class="align-center" src="../../../_images/control-diagram.svg" /><p>The <code class="code docutils literal notranslate"><span class="pre">Controller</span></code> tries to regulate the <code class="code docutils literal notranslate"><span class="pre">Output</span></code> to match the <code class="code docutils literal notranslate"><span class="pre">Reference</span></code>.
The <code class="code docutils literal notranslate"><span class="pre">Controller</span> <span class="pre">Output</span></code> is applied to the <code class="code docutils literal notranslate"><span class="pre">Plant</span></code>, along with the <code class="code docutils literal notranslate"><span class="pre">Disturbance</span></code>.
The total applied input to the plant is called the <code class="code docutils literal notranslate"><span class="pre">Plant</span> <span class="pre">Input</span></code>.</p>
<section id="use-case-1-references">
<h3>Use Case 1: References<a class="headerlink" href="#use-case-1-references" title="Permalink to this heading">¶</a></h3>
<img alt="../../../_images/control-diagram-inj-ref.svg" class="align-center" src="../../../_images/control-diagram-inj-ref.svg" /><p>The first use case is to place an injection point supplying the <code class="code docutils literal notranslate"><span class="pre">Reference</span></code> signal.
Doing so allows generic signals to be commanded to the system, such as constants, noise, etc.
This could be implemented in “user-land” as a custom command, but building on top of the injection module is much easier.</p>
</section>
<section id="use-case-2-controller-output">
<h3>Use Case 2: Controller Output<a class="headerlink" href="#use-case-2-controller-output" title="Permalink to this heading">¶</a></h3>
<img alt="../../../_images/control-diagram-inj-ctrl-output.svg" class="align-center" src="../../../_images/control-diagram-inj-ctrl-output.svg" /><p>By inserting an injection point for the <code class="code docutils literal notranslate"><span class="pre">Controller</span> <span class="pre">Output</span></code>, the injection can be used to either add a simulated disturbance, or to replace the controller and apply open-loop inputs to the <cite>Plant</cite>.</p>
<section id="disturbance">
<h4>Disturbance<a class="headerlink" href="#disturbance" title="Permalink to this heading">¶</a></h4>
<p>If the injection point is configured to sum the internal function with the input signal, this injection point effectively adds an artificial disturbance to the system.
This can be used to estimate the controller’s disturbance rejection properties.</p>
</section>
<section id="open-loop-plant-input">
<h4>Open-Loop Plant Input<a class="headerlink" href="#open-loop-plant-input" title="Permalink to this heading">¶</a></h4>
<p>If the injection point is configured to override the input signal and simply use the internal function generator output as the block output, the controller is effectively disabled and the injection point allows the user to apply arbitary inputs to the plant.
Remember that this is possible without any changes to the running control code; after an injection point is added (while writting the C-code), it can be activated any time.</p>
</section>
</section>
<section id="use-case-3-non-ideal-sensor">
<h3>Use Case 3: Non-Ideal Sensor<a class="headerlink" href="#use-case-3-non-ideal-sensor" title="Permalink to this heading">¶</a></h3>
<p>The first two use cases are the most common places to add injection points.
However, they can be added anywhere and everywhere in the control algorithm!
For example, adding an injection point inline with the sensor feedback can be used to emulate sensor offsets or noise.</p>
<p>In general, you might consider adding injection points to all signals flowing in the controller.</p>
</section>
</section>
<section id="adding-injection-points-to-c-code">
<h2>Adding Injection Points to C-Code<a class="headerlink" href="#adding-injection-points-to-c-code" title="Permalink to this heading">¶</a></h2>
<p>Now that you understand injection points and how they can be used in control algorithms, we will discuss how to modify the C-code.</p>
<p>All relevant system code can be found in the <code class="code docutils literal notranslate"><span class="pre">sys/injection</span></code> and <code class="code docutils literal notranslate"><span class="pre">sys/cmd/cmd_inj</span></code> modules.</p>
<section id="step-1-create-context">
<h3>Step 1: Create Context<a class="headerlink" href="#step-1-create-context" title="Permalink to this heading">¶</a></h3>
<p>You must create a <strong>context</strong> for each injection point.
The context is of type <code class="code docutils literal notranslate"><span class="pre">inj_ctx_t</span></code>.
Normally, these are <code class="code docutils literal notranslate"><span class="pre">static</span></code> variables defined within task C files.</p>
<p>For example, in <code class="code docutils literal notranslate"><span class="pre">task_foo.c</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;sys/injection.h&quot;</span>

<span class="c1">// ...</span>

<span class="c1">// Array of 4 contexts (i.e., 4 injection points)</span>
<span class="k">static</span><span class="w"> </span><span class="n">inj_ctx_t</span><span class="w"> </span><span class="n">inj_ctx_ctrl</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">};</span>

<span class="c1">// ...</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>If you receive code complilation errors, make sure you have enabled the injection module in <code class="docutils literal notranslate"><span class="pre">app_cpu1/usr/user_config.h</span></code> by editting the <code class="docutils literal notranslate"><span class="pre">USER_CONFIG_ENABLE_INJECTION</span></code> define.</p>
</div>
</section>
<section id="step-2-initialize-and-register-context">
<h3>Step 2: Initialize and Register Context<a class="headerlink" href="#step-2-initialize-and-register-context" title="Permalink to this heading">¶</a></h3>
<p>Next, you need to initialize and register the context once when the system boots.</p>
<p>You will need to determine suitable ASCII names for each injection point.
These strings will be typed into the commands so the system knows which injection point is being used.
For example, <code class="code docutils literal notranslate"><span class="pre">Iq*</span></code> might mean the q-axis current reference.</p>
<p>For example, in <code class="code docutils literal notranslate"><span class="pre">task_foo.c</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">task_foo_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>

<span class="w">    </span><span class="c1">// Initialize signal injection points</span>
<span class="w">    </span><span class="n">injection_ctx_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">inj_ctx_ctrl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="s">&quot;Id*&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">injection_ctx_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">inj_ctx_ctrl</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="s">&quot;Iq*&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">injection_ctx_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">inj_ctx_ctrl</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="s">&quot;Tem*&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">injection_ctx_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">inj_ctx_ctrl</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="s">&quot;omega_m*&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Register all signal injection points</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">inj_ctx_ctrl</span><span class="p">);</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">injection_ctx_register</span><span class="p">(</span><span class="o">&amp;</span><span class="n">inj_ctx_ctrl</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">task_foo_clear</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>

<span class="w">    </span><span class="c1">// Clear all injection points</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">inj_ctx_ctrl</span><span class="p">);</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">injection_ctx_clear</span><span class="p">(</span><span class="o">&amp;</span><span class="n">inj_ctx_ctrl</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="step-3-inject-during-callback">
<h3>Step 3: Inject During Callback<a class="headerlink" href="#step-3-inject-during-callback" title="Permalink to this heading">¶</a></h3>
<p>Finally, you use the injection points by calling <code class="code docutils literal notranslate"><span class="pre">injection_inj()</span></code> once per callback, once per injection point.
This function requires 3 arguments:</p>
<ol class="arabic simple">
<li><p>Pointer to the variable into which you want to inject</p></li>
<li><p>Pointer to the injection context</p></li>
<li><p>Timestep length since last calling the function (i.e. <code class="code docutils literal notranslate"><span class="pre">Ts</span></code>)</p></li>
</ol>
<p>For example, in <code class="code docutils literal notranslate"><span class="pre">task_foo.c</span></code>:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">Id_star</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">Iq_star</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">Tem_star</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">omega_m_star</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">task_foo_callback</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>

<span class="w">    </span><span class="c1">// Perform signal injections</span>
<span class="w">    </span><span class="n">injection_inj</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Id_star</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">inj_ctx_ctrl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">Ts</span><span class="p">);</span>
<span class="w">    </span><span class="n">injection_inj</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Iq_star</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">inj_ctx_ctrl</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">Ts</span><span class="p">);</span>
<span class="w">    </span><span class="n">injection_inj</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Tem_star</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">inj_ctx_ctrl</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">Ts</span><span class="p">);</span>
<span class="w">    </span><span class="n">injection_inj</span><span class="p">(</span><span class="o">&amp;</span><span class="n">omega_m_star</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">inj_ctx_ctrl</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">Ts</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Now, the local variables have the signal contents</span>
<span class="w">    </span><span class="c1">// injected into them as requested by the user.</span>

<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="using-injection-commands">
<h2>Using Injection Commands<a class="headerlink" href="#using-injection-commands" title="Permalink to this heading">¶</a></h2>
<p>Now that the C-code has been instrumented for signal injection, the <code class="code docutils literal notranslate"><span class="pre">inj</span></code> commands can be used.</p>
<p>Per the <code class="code docutils literal notranslate"><span class="pre">help</span></code> output, the <code class="code docutils literal notranslate"><span class="pre">inj</span></code> sub-commands are:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">clear</span></code> - Clear all injections</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">list</span></code> - List all available injection points</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">const</span> <span class="pre">&lt;name&gt;</span> <span class="pre">&lt;set|add|sub&gt;</span> <span class="pre">&lt;value&gt;</span></code> - Inject a constant</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">noise</span> <span class="pre">&lt;name&gt;</span> <span class="pre">&lt;set|add|sub&gt;</span> <span class="pre">&lt;gain&gt;</span> <span class="pre">&lt;offset&gt;</span></code> - Inject noise</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">chirp</span> <span class="pre">&lt;name&gt;</span> <span class="pre">&lt;set|add|sub&gt;</span> <span class="pre">&lt;gain&gt;</span> <span class="pre">&lt;freqMin&gt;</span> <span class="pre">&lt;freqMax&gt;</span> <span class="pre">&lt;period&gt;</span></code> - Inject chirp</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">triangle</span> <span class="pre">&lt;name&gt;</span> <span class="pre">&lt;set|add|sub&gt;</span> <span class="pre">&lt;valueMin&gt;</span> <span class="pre">&lt;valueMax&gt;</span> <span class="pre">&lt;period&gt;</span></code> - Inject triangle</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">square</span> <span class="pre">&lt;name&gt;</span> <span class="pre">&lt;set|add|sub&gt;</span> <span class="pre">&lt;valueMin&gt;</span> <span class="pre">&lt;valueMax&gt;</span> <span class="pre">&lt;period&gt;</span></code> - Inject square</p></li>
</ul>
<p>Start by typing <code class="code docutils literal notranslate"><span class="pre">inj</span> <span class="pre">list</span></code> to see all registered injection points.</p>
<p>Next, to clear previous injections, type <code class="code docutils literal notranslate"><span class="pre">inj</span> <span class="pre">clear</span></code>.</p>
<p>To inject a signal, all commands follow a similar flavor.
First, determine the type of signal (e.g., noise).
Next, determine the signal name, as defined in the <code class="code docutils literal notranslate"><span class="pre">register()</span></code> command in the C-code.
For the previous example, <code class="code docutils literal notranslate"><span class="pre">Id*</span></code> and <code class="code docutils literal notranslate"><span class="pre">Iq*</span></code> would be valid.
Then, determine if the signal generator should override (i.e., <code class="code docutils literal notranslate"><span class="pre">set</span></code>) or sum (i.e., <code class="code docutils literal notranslate"><span class="pre">add/sub</span></code>) with the input signal.
Finally, determine the parameters for the specific function generator.</p>
<p>Note that parameter values can be entered in normal decimal format, or scientific format.
For example, to specify 1 micro-unit, type either <code class="code docutils literal notranslate"><span class="pre">0.000001</span></code> or <code class="code docutils literal notranslate"><span class="pre">1e-6</span></code>.</p>
<section id="constant-injection">
<h3>Constant Injection<a class="headerlink" href="#constant-injection" title="Permalink to this heading">¶</a></h3>
<p>Example <code class="code docutils literal notranslate"><span class="pre">constant</span></code> injection where the <code class="code docutils literal notranslate"><span class="pre">gain</span> <span class="pre">=</span> <span class="pre">0.6</span></code>:</p>
<figure class="align-default">
<img alt="../../../_images/index-1.svg" class="plot-directive align-plot-left" src="../../../_images/index-1.svg" /></figure>
<p><strong>Syntax:</strong> <code class="code docutils literal notranslate"><span class="pre">inj</span> <span class="pre">const</span> <span class="pre">&lt;name&gt;</span> <span class="pre">&lt;set|add|sub&gt;</span> <span class="pre">&lt;value&gt;</span></code></p>
<p>The most basic injection.</p>
<p>Only requires specifying the constant value.
The units of the value are relative to the control variable.</p>
</section>
<section id="noise-injection">
<h3>Noise Injection<a class="headerlink" href="#noise-injection" title="Permalink to this heading">¶</a></h3>
<p>Example <code class="code docutils literal notranslate"><span class="pre">noise</span></code> injection where the <code class="code docutils literal notranslate"><span class="pre">gain</span> <span class="pre">=</span> <span class="pre">0.3</span></code> and the <code class="code docutils literal notranslate"><span class="pre">offset</span> <span class="pre">=</span> <span class="pre">0.5</span></code>:</p>
<figure class="align-default">
<img alt="../../../_images/index-2.svg" class="plot-directive align-plot-left" src="../../../_images/index-2.svg" /></figure>
<p><strong>Syntax:</strong> <code class="code docutils literal notranslate"><span class="pre">inj</span> <span class="pre">noise</span> <span class="pre">&lt;name&gt;</span> <span class="pre">&lt;set|add|sub&gt;</span> <span class="pre">&lt;gain&gt;</span> <span class="pre">&lt;offset&gt;</span></code></p>
<p>Injects white noise into the signal.
The noise is computed using <code class="code docutils literal notranslate"><span class="pre">rand()</span></code> (ranges from -1.0 to 1.0) and is scaled to +/- <code class="code docutils literal notranslate"><span class="pre">gain</span></code>.
The <code class="code docutils literal notranslate"><span class="pre">offset</span></code> is summed with the noise to provide average-valued noise.</p>
<p>Note: noise injection with <code class="code docutils literal notranslate"><span class="pre">gain</span> <span class="pre">=</span> <span class="pre">0</span></code> and <code class="code docutils literal notranslate"><span class="pre">offset</span> <span class="pre">=</span> <span class="pre">G</span></code> is the same as constant injection with <code class="code docutils literal notranslate"><span class="pre">value</span> <span class="pre">=</span> <span class="pre">G</span></code>.</p>
</section>
<section id="chirp-injection">
<h3>Chirp Injection<a class="headerlink" href="#chirp-injection" title="Permalink to this heading">¶</a></h3>
<p>Example <code class="code docutils literal notranslate"><span class="pre">chirp</span></code> injection where the <code class="code docutils literal notranslate"><span class="pre">gain</span> <span class="pre">=</span> <span class="pre">0.6</span></code>, <code class="code docutils literal notranslate"><span class="pre">freqMin</span> <span class="pre">=</span> <span class="pre">1</span></code>, <code class="code docutils literal notranslate"><span class="pre">freqMax</span> <span class="pre">=</span> <span class="pre">3</span></code>, and <code class="code docutils literal notranslate"><span class="pre">period</span> <span class="pre">=</span> <span class="pre">5</span></code>:</p>
<figure class="align-default">
<img alt="../../../_images/index-3.svg" class="plot-directive align-plot-left" src="../../../_images/index-3.svg" /></figure>
<p><strong>Syntax:</strong> <code class="code docutils literal notranslate"><span class="pre">inj</span> <span class="pre">chirp</span> <span class="pre">&lt;name&gt;</span> <span class="pre">&lt;set|add|sub&gt;</span> <span class="pre">&lt;gain&gt;</span> <span class="pre">&lt;freqMin&gt;</span> <span class="pre">&lt;freqMax&gt;</span> <span class="pre">&lt;period&gt;</span></code></p>
<p>Injects a linear <a class="reference external" href="https://en.wikipedia.org/wiki/Chirp">chirp</a> signal that ramps up and down in frequency, i.e., a back-to-back chirp.
Ideally, there are no discontinuities in the output.</p>
<p>The frequency values (<code class="code docutils literal notranslate"><span class="pre">freqMin</span></code> and <code class="code docutils literal notranslate"><span class="pre">freqMax</span></code>) are in Hz and <code class="code docutils literal notranslate"><span class="pre">period</span></code> is in seconds.</p>
<p>The chirp implementation ramps the frequency from the min to max value over <code class="code docutils literal notranslate"><span class="pre">period/2</span></code> seconds, then ramps from the max to min frequency over the second half of the period.
This allows for continuous output.</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">gain</span></code> value is in units relative to the injected control variable.</p>
<p>Note that a chirp can become a simple sinusoid by setting the min and max frequency equal and an appropriate period.
The period should be set such that it does not clip the sinusoidal output, i.e., period should contain an integer number of complete waveforms.</p>
</section>
<section id="triangle-injection">
<h3>Triangle Injection<a class="headerlink" href="#triangle-injection" title="Permalink to this heading">¶</a></h3>
<p>Example <code class="code docutils literal notranslate"><span class="pre">triangle</span></code> injection where the <code class="code docutils literal notranslate"><span class="pre">valueMin</span> <span class="pre">=</span> <span class="pre">0.35</span></code>, <code class="code docutils literal notranslate"><span class="pre">valueMax</span> <span class="pre">=</span> <span class="pre">0.85</span></code>, and <code class="code docutils literal notranslate"><span class="pre">period</span> <span class="pre">=</span> <span class="pre">0.65</span></code>:</p>
<figure class="align-default">
<img alt="../../../_images/index-4.svg" class="plot-directive align-plot-left" src="../../../_images/index-4.svg" /></figure>
<p><strong>Syntax:</strong> <code class="code docutils literal notranslate"><span class="pre">inj</span> <span class="pre">triangle</span> <span class="pre">&lt;name&gt;</span> <span class="pre">&lt;set|add|sub&gt;</span> <span class="pre">&lt;valueMin&gt;</span> <span class="pre">&lt;valueMax&gt;</span> <span class="pre">&lt;period&gt;</span></code></p>
<p>Injects a triangle wave ranging from the min value to the max value and back, over the period.
The waveform starts at the mid-value between min and max.</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">period</span></code> parameter is in seconds.</p>
</section>
<section id="square-injection">
<h3>Square Injection<a class="headerlink" href="#square-injection" title="Permalink to this heading">¶</a></h3>
<p>Example <code class="code docutils literal notranslate"><span class="pre">square</span></code> injection where the <code class="code docutils literal notranslate"><span class="pre">valueMin</span> <span class="pre">=</span> <span class="pre">0.3</span></code>, <code class="code docutils literal notranslate"><span class="pre">valueMax</span> <span class="pre">=</span> <span class="pre">0.8</span></code>, and <code class="code docutils literal notranslate"><span class="pre">period</span> <span class="pre">=</span> <span class="pre">0.75</span></code>:</p>
<figure class="align-default">
<img alt="../../../_images/index-5.svg" class="plot-directive align-plot-left" src="../../../_images/index-5.svg" /></figure>
<p><strong>Syntax:</strong> <code class="code docutils literal notranslate"><span class="pre">inj</span> <span class="pre">square</span> <span class="pre">&lt;name&gt;</span> <span class="pre">&lt;set|add|sub&gt;</span> <span class="pre">&lt;valueMin&gt;</span> <span class="pre">&lt;valueMax&gt;</span> <span class="pre">&lt;period&gt;</span></code></p>
<p>Injects a square wave going from the min value to the max value and back, over the period.
The waveform starts at the min value.
The duty cycle is 50%.</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">period</span></code> parameter is in seconds.</p>
<!-- This block updates all the inline plots on the page and makes them left justified -->
<script>
var my_plots = document.getElementsByClassName("align-plot-left");
for (var i = 0; i < my_plots.length; i++) {
    my_plots[i].parentNode.style = "text-align:left";
}
</script></section>
</section>
</section>

        </article>
      </div>
      <footer>
        

        <div class="related-pages">
          <a class="next-page" href="../task-profiling.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Task Profiling</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../logging/streaming.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Signal Logging (Streaming)</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2018-2025, Electric Machinery and Levitation Laboratory
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Mar 27, 2024</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-74WCSDC0D0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-74WCSDC0D0');
</script>

<div class="google-analytics-tracking-info">
This page uses <a href="https://analytics.google.com/">Google Analytics</a> to collect statistics. Disable by blocking JavaScript from www.google-analytics.com.
</div>


      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Signal Injection</a><ul>
<li><a class="reference internal" href="#what-are-injections">What Are Injections?</a></li>
<li><a class="reference internal" href="#example-use-cases">Example Use Cases</a><ul>
<li><a class="reference internal" href="#use-case-1-references">Use Case 1: References</a></li>
<li><a class="reference internal" href="#use-case-2-controller-output">Use Case 2: Controller Output</a><ul>
<li><a class="reference internal" href="#disturbance">Disturbance</a></li>
<li><a class="reference internal" href="#open-loop-plant-input">Open-Loop Plant Input</a></li>
</ul>
</li>
<li><a class="reference internal" href="#use-case-3-non-ideal-sensor">Use Case 3: Non-Ideal Sensor</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-injection-points-to-c-code">Adding Injection Points to C-Code</a><ul>
<li><a class="reference internal" href="#step-1-create-context">Step 1: Create Context</a></li>
<li><a class="reference internal" href="#step-2-initialize-and-register-context">Step 2: Initialize and Register Context</a></li>
<li><a class="reference internal" href="#step-3-inject-during-callback">Step 3: Inject During Callback</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-injection-commands">Using Injection Commands</a><ul>
<li><a class="reference internal" href="#constant-injection">Constant Injection</a></li>
<li><a class="reference internal" href="#noise-injection">Noise Injection</a></li>
<li><a class="reference internal" href="#chirp-injection">Chirp Injection</a></li>
<li><a class="reference internal" href="#triangle-injection">Triangle Injection</a></li>
<li><a class="reference internal" href="#square-injection">Square Injection</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/design-tabs.js"></script>
    </body>
</html>